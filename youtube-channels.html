<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Channels - Parental Control</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Material Symbols -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- CSS -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/content-limits.css"> <!-- Reusing header/container styles -->
    <link rel="stylesheet" href="css/website-rules.css">
</head>

<body>
    <div class="background-gradient"></div>

    <div class="limits-container rules-container">
        <!-- Header -->
        <header class="page-header">
            <button class="back-button" onclick="location.href='content-limits.html'">
                <span class="material-symbols-outlined">arrow_back</span>
            </button>
            <h1 class="header-title">YouTube Channels</h1>
            <div class="header-actions">
                <button class="icon-button" onclick="YouTubeManager.refresh()">
                    <span class="material-symbols-outlined">refresh</span>
                </button>
            </div>
        </header>

        <main class="main-content">
            <!-- Global Options -->
            <div class="feature-toggle-card">
                <div class="feature-info">
                    <h3>Content Tracking</h3>
                    <p>Log watched video history</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" checked>
                    <span class="slider"></span>
                </label>
            </div>

            <div class="feature-toggle-card">
                <div class="feature-info">
                    <h3>Block Shorts</h3>
                    <p>Prevent access to YouTube Shorts</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox">
                    <span class="slider"></span>
                </label>
            </div>

            <!-- Blocked List -->
            <div class="list-section-header">
                <span id="blocked-count">Blocked Channels (0)</span>
            </div>
            <div class="rules-list" id="blocked-list"></div>

            <!-- Allowed List -->
            <div class="list-section-header">
                <span id="allowed-count">Allowed Channels (0)</span>
            </div>
            <div class="rules-list" id="allowed-list"></div>
        </main>
    </div>

    <script>
        // Data Store
        const defaultChannels = [
            { id: 'yt-khan', name: 'Khan Academy', meta: '8.2M Subscribers', icon: 'K', allowed: true },
            { id: 'yt-crash', name: 'CrashCourse', meta: '14M Subscribers', icon: 'C', allowed: true },
            { id: 'yt-natgeo', name: 'National Geographic', meta: '22M Subscribers', icon: 'N', allowed: true },
            { id: 'yt-dude', name: 'Dude Perfect', meta: '59M Subscribers', icon: 'D', allowed: false },
            { id: 'yt-pew', name: 'PewDiePie', meta: '111M Subscribers', icon: 'P', allowed: false },
            { id: 'yt-mrbeast', name: 'MrBeast', meta: '200M Subscribers', icon: 'M', allowed: true },
            { id: 'yt-5min', name: '5-Minute Crafts', meta: '80M Subscribers', icon: '5', allowed: true }
        ];

        let channelsData = JSON.parse(JSON.stringify(defaultChannels));

        const YouTubeManager = {
            init() {
                // Try to load from localStorage if we were persisting globally
                // For now, load default
                this.render();
            },

            refresh() {
                // Simulate refresh
                const list = document.getElementById('allowed-list');
                list.style.opacity = '0.5';
                setTimeout(() => {
                    list.style.opacity = '1';
                    // Randomly shuffle or just re-render
                    this.render();
                    alert('Channels refreshed');
                }, 500);
            },

            toggleChannel(id) {
                const channel = channelsData.find(c => c.id === id);
                if (channel) {
                    channel.allowed = !channel.allowed;
                    this.render();
                }
            },

            render() {
                const allowed = channelsData.filter(c => c.allowed);
                const blocked = channelsData.filter(c => !c.allowed);

                document.getElementById('allowed-count').textContent = `Allowed Channels (${allowed.length})`;
                document.getElementById('blocked-count').textContent = `Blocked Channels (${blocked.length})`;

                this.renderList(allowed, 'allowed-list');
                this.renderList(blocked, 'blocked-list');
            },

            renderList(items, containerId) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';

                if (items.length === 0) {
                    container.innerHTML = `<div class="empty-state">No channels</div>`;
                    return;
                }

                items.forEach(item => {
                    const div = document.createElement('div');
                    div.className = `rule-item ${!item.allowed ? 'blocked' : ''}`;

                    // Icon Consistency Logic
                    let iconHtml = '';
                    if (item.icon.includes('/') || item.icon.startsWith('http')) {
                        iconHtml = `<img src="${item.icon}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                    } else if (item.icon.length === 1) {
                        iconHtml = item.icon; // Single letter
                    } else {
                        iconHtml = `<span class="material-symbols-outlined">${item.icon}</span>`;
                    }

                    div.innerHTML = `
                        <div class="item-icon">
                            ${iconHtml}
                        </div>
                        <div class="item-details">
                            <h3 class="item-name">${item.name}</h3>
                            <p class="item-meta">${item.meta}</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" ${item.allowed ? 'checked' : ''} onchange="YouTubeManager.toggleChannel('${item.id}')">
                            <span class="slider"></span>
                        </label>
                    `;
                    container.appendChild(div);
                });
            }
        };

        document.addEventListener('DOMContentLoaded', () => YouTubeManager.init());
    </script>
</body>

</html>